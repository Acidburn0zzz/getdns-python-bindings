

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pygetdns: Python bindings for getdns &mdash; pygetdns 0.1.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="pygetdns 0.1.1 documentation" href="#" />
    <link rel="next" title="pygetdns function reference" href="functions.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="functions.html" title="pygetdns function reference"
             accesskey="N">next</a> |</li>
        <li><a href="#">pygetdns 0.1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="pygetdns-python-bindings-for-getdns">
<h1>pygetdns: Python bindings for getdns<a class="headerlink" href="#pygetdns-python-bindings-for-getdns" title="Permalink to this headline">¶</a></h1>
<p>&#8220;pygetdns&#8221; is an implementation of Python language bindings
for the <a class="reference external" href="http://getdnsapi.net/">getdns</a> API.  getdns is a
modern, asynchronous DNS API that simplifies access to
advanced DNS features, including DNSSEC.  The API
<a class="reference external" href="http://www.vpnc.org/getdns-api/">specification</a> was
developed by Paul Hoffman.  pygetdns is built on top of the
getdns implementation developed as a joint project between
<a class="reference external" href="http://labs.verisigninc.com/en_US/innovation/verisign-labs/index.xhtml">Verisign Labs</a>
and <a class="reference external" href="http://nlnetlabs.nl/">NLnet Labs</a>.</p>
<p>We have tried to keep this interface as Pythonic as we can
while staying true to the getdns architecture.  We have
plans for a future version that is more consistent with
Python object design.</p>
<div class="section" id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<p>This version of pygetdns has been built and tested against Python
2.7.  We also expect these other prerequisites to be
installed:</p>
<ul class="simple">
<li><a class="reference external" href="http://getdnsapi.net/">libgetdns</a>, version 0.1.1</li>
<li><a class="reference external" href="https://www.nlnetlabs.nl/projects/ldns/">libldns</a>,
version 1.6.11 or later</li>
<li><a class="reference external" href="http://www.nlnetlabs.nl/projects/unbound/">libunbound</a>, version
1.4.16 or later</li>
<li><a class="reference external" href="http://expat.sourceforge.net/">libexpat</a> (needed for unbound)</li>
<li><a class="reference external" href="http://www.gnu.org/software/libidn/">libidn</a> version 1</li>
<li><a class="reference external" href="http://libevent.org/">libevent</a> version 2.0.21 stable</li>
</ul>
<p>n.b.: libgetdns <em>must</em> be built with the libevent extension,
as follows:</p>
<div class="highlight-python"><pre>./configure --with-libevent</pre>
</div>
</div>
<div class="section" id="building">
<h2>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h2>
<p>The code repository for pygetdns is available at:
<tt class="docutils literal"><span class="pre">&lt;whatever</span></tt>&gt;.  If you are building from source you will
need the Python development package for Python 2.7.  On
Linux systems this is typically something along the lines of
&#8220;python-dev&#8221; or &#8220;python2.7-dev&#8221;, available through your
package system.  On Mac OS we are building against the
python.org release, available in source form <a class="reference external" href="https://www.python.org/download/releases/2.7.4">here</a>.</p>
<p>For the actual build, we are using the standard Python
<a class="reference external" href="https://docs.python.org/2/distutils/">distutils</a>.  To
build and install:</p>
<div class="highlight-python"><pre>python setup.py build
python setup.py install</pre>
</div>
</div>
<div class="section" id="using-pygetdns">
<h2>Using pygetdns<a class="headerlink" href="#using-pygetdns" title="Permalink to this headline">¶</a></h2>
<div class="section" id="contexts">
<h3>Contexts<a class="headerlink" href="#contexts" title="Permalink to this headline">¶</a></h3>
<p>All pygetdns queries happen within a <em>context</em>, and among
the first tasks you&#8217;ll need to do before issuing a query is
to acquire one using getdns.context_create().  A context is
an opaque data structure describing the environment within
which the query and replies will take place, including
elements such as DNSSEC validation, whether the resolution
should be performed as a recursive resolver or a stub
resolver, and so on.  The state of a given context can be
queried with getdns.context_get_api_information().</p>
<p>See section 8 of the <a class="reference external" href="http://www.vpnc.org/getdns-api/">API
specification</a></p>
</div>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>In this example, we do a simple address lookup and dump the
results to the screen:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">getdns</span><span class="o">,</span> <span class="nn">pprint</span><span class="o">,</span> <span class="nn">sys</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
      <span class="k">print</span> <span class="s">&quot;Usage: {0} hostname&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
      <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

  <span class="n">ctx</span> <span class="o">=</span> <span class="n">getdns</span><span class="o">.</span><span class="n">context_create</span><span class="p">()</span>
  <span class="n">extensions</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;return_both_v4_and_v6&quot;</span><span class="p">:</span> <span class="n">getdns</span><span class="o">.</span><span class="n">GETDNS_EXTENSION_TRUE</span> <span class="p">}</span>
  <span class="n">results</span> <span class="o">=</span> <span class="n">getdns</span><span class="o">.</span><span class="n">address</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="s">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">getdns</span><span class="o">.</span><span class="n">GETDNS_RESPSTATUS_GOOD</span><span class="p">:</span>
      <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Addresses: &quot;</span><span class="p">)</span>

      <span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="s">&quot;just_address_answers&quot;</span><span class="p">]:</span>
          <span class="k">print</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">addr</span><span class="p">[</span><span class="s">&quot;IPSTRING&quot;</span><span class="p">])</span>
      <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">)</span>
      <span class="k">print</span> <span class="s">&quot;Entire results tree: &quot;</span>
      <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="s">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span>  <span class="n">getdns</span><span class="o">.</span><span class="n">GETDNS_RESPSTATUS_NO_NAME</span><span class="p">:</span>
      <span class="k">print</span> <span class="s">&quot;{0} not found&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>In this example, we do a DNSSEC query and check the response:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">getdns</span><span class="o">,</span> <span class="nn">pprint</span><span class="o">,</span> <span class="nn">sys</span>

<span class="n">dnssec_status</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&quot;GETDNS_DNSSEC_SECURE&quot;</span> <span class="p">:</span> <span class="mi">400</span><span class="p">,</span>
    <span class="s">&quot;GETDNS_DNSSEC_BOGUS&quot;</span> <span class="p">:</span> <span class="mi">401</span><span class="p">,</span>
    <span class="s">&quot;GETDNS_DNSSEC_INDETERINATE&quot;</span> <span class="p">:</span> <span class="mi">402</span><span class="p">,</span>
    <span class="s">&quot;GETDNS_DNSSEC_INSECURE&quot;</span> <span class="p">:</span> <span class="mi">403</span><span class="p">,</span>
    <span class="s">&quot;GETDNS_DNSSEC_NOT_PERFORMED&quot;</span> <span class="p">:</span> <span class="mi">404</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">dnssec_message</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">dnssec_status</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">dnssec_status</span><span class="p">[</span><span class="n">message</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">message</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;Usage: {0} hostname&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">ctx</span> <span class="o">=</span> <span class="n">getdns</span><span class="o">.</span><span class="n">context_create</span><span class="p">()</span>
    <span class="n">extensions</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;return_both_v4_and_v6&quot;</span> <span class="p">:</span> <span class="n">getdns</span><span class="o">.</span><span class="n">GETDNS_EXTENSION_TRUE</span><span class="p">,</span>
                   <span class="s">&quot;dnssec_return_status&quot;</span> <span class="p">:</span> <span class="n">getdns</span><span class="o">.</span><span class="n">GETDNS_EXTENSION_TRUE</span> <span class="p">}</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">getdns</span><span class="o">.</span><span class="n">address</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="s">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">getdns</span><span class="o">.</span><span class="n">GETDNS_RESPSTATUS_GOOD</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Addresses: &quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="s">&quot;just_address_answers&quot;</span><span class="p">]:</span>
            <span class="k">print</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">addr</span><span class="p">[</span><span class="s">&quot;IPSTRING&quot;</span><span class="p">])</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="s">&quot;replies_tree&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="s">&quot;dnssec_status&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">print</span> <span class="s">&quot;{0}: dnssec_status: {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s">&quot;canonical_name&quot;</span><span class="p">],</span>
                                                       <span class="n">dnssec_message</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s">&quot;dnssec_status&quot;</span><span class="p">]))</span>

    <span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="s">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">getdns</span><span class="o">.</span><span class="n">GETDNS_RESPSTATUS_NO_NAME</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;{0} not found&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>Contents:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="functions.html"><tt class="docutils literal"><span class="pre">pygetdns</span></tt> function reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="response.html"><tt class="docutils literal"><span class="pre">pygetdns</span></tt> response data</a></li>
</ul>
</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h2>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><em>Index</em></a></li>
<li><a class="reference internal" href="py-modindex.html"><em>Module Index</em></a></li>
<li><a class="reference internal" href="search.html"><em>Search Page</em></a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">pygetdns: Python bindings for getdns</a><ul>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li><a class="reference internal" href="#building">Building</a></li>
<li><a class="reference internal" href="#using-pygetdns">Using pygetdns</a><ul>
<li><a class="reference internal" href="#contexts">Contexts</a></li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>

  <h4>Next topic</h4>
  <p class="topless"><a href="functions.html"
                        title="next chapter"><tt class="docutils literal"><span class="pre">pygetdns</span></tt> function reference</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="functions.html" title="pygetdns function reference"
             >next</a> |</li>
        <li><a href="#">pygetdns 0.1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Verisign Labs, NLnet Labs.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>